<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mapa Google – Puntos desde Sheets</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
    }
    #map {
      width: 100%;
      height: 100vh;
    }
  </style>
</head>
<body>

<div id="map"></div>

<script>
async function initMap() {

  // 1️⃣ Crear mapa base
  const map = new google.maps.Map(document.getElementById("map"), {
    zoom: 5,
    center: { lat: 4.57, lng: -74.29 }
  });

  try {
    // 2️⃣ Llamar Apps Script
    const response = await fetch(
      "https://script.google.com/macros/s/AKfycbwXQeHM27GSPK2pDTWH6wAFM1Sag49Lc9hgeWMrx8vlJs97A78Exh87fwVNZPF5Py5yHw/exec"
    );
    const puntos = await response.json();

    // 3️⃣ Ajustar vista a los puntos
    const bounds = new google.maps.LatLngBounds();

    puntos.forEach(p => {
      if (typeof p.lat === "number" && typeof p.lng === "number") {
        const pos = { lat: p.lat, lng: p.lng };
        bounds.extend(pos);

        new google.maps.Marker({
          position: pos,
          map
        });
      }
    });

    if (puntos.length > 0) {
      map.fitBounds(bounds);
    }

  } catch (err) {
    alert("Error cargando puntos: " + err);
  }
}
</script>

<script async
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDv4c9pg62TuPHSbbdRQFsQJqvpIv5_Jqg&callback=initMap">
</script>

</body>
</html>

